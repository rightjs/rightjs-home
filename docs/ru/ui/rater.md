# Рейтинг

`Rater` - это простой виджет RightJS для создания полей рейтингов. Он может работать
как независимый виджет, может отсылать результаты голосований через {Xhr} запросы, а 
так же может работать в составе форм.

<%= partial '/ui/head', :locals => {:name => 'rater'} %>

<%= anchors_index %>


## Список возможностей, :features

* Может работать как независимый виджет
* Может работать как часть формы
* Может отсылать результаты голосования через {Xhr} запросы
* Очень простое использование
* Все в одном маленьком файле (2.3k)


## Принципы использования, :usage

Для использования виджета, подключите один из выше перечисленных файлов на вашу страницу.
После этого у вас будет выбор. Использовать класс `Rater` программно из ваших скриптов.

    new Rater({url: '/boo'}).insertTo('my-conatiner');

Или вы можете создать структуру элементов в нужном месте вручную, указав css-класс
`right-rater`. Скрипт автоматически найдет данный элемент и назначит все нужные
обработчики событий.

    <div class="right-rater" data-rater-options="{url:'/boo'}">
      <div>★</div>
      <div>★</div>
      <div>★</div>
      <div>★</div>
      <div>★</div>
    </div>

Это так же позволит вам использовать все что угодно, вместо текстовых звездочек.


## Назначенные рейтинги, :assigned

Вы так же можете назначить виджет рейтинга на работу с любым полем ввода, например
скрытым полем, так что он будет работать как часть какой либо формы. Для этого вы
можете либо указать совместно-используемое поле в опции `update` или использовать
метод `assignTo()`

    <form ...>
      <input type="hidden" id="the-rating" name="rating" />
  
      // для автоматически инициализируемого элемента
      <div class="right-rater"
        data-rater-options="{update:'the-rating}">
        ...
      </div>
  
      // с опциями конструктора
      new Rater({update: 'the-rating'})
        .insertTo('the-rating', 'after');
  
      // или напрямую методом
      new Rater().insertTo('the-rating', 'after')
        .assignTo('the-rating');
    </form>

__ВНИМАНИЕ:__ назначение работает в обе стороны. Когда пользователь меняет значение
в виджете, скрипт меняет значение в поле. Но когда вы меняете значение в поле,
это автоматически будет менять значение виджета.


## Удаленный рейтинг, :remote

Виджет рейтинга может автоматически отправлять данные на сервер через {Xhr} запрос когда пользователь
выбирает какое-либо значение. Для этой цели используются следующие три опции

* `url` - url-адрес куда отсылать результаты
* `param` - имя параметра для рейтинга, `'rate'` по умолчанию
* `Xhr` - дополнительные опции для {Xhr} запросов

Простой пример может выглядеть следующим образом

    new Rater({
      url: '/some/stuff/rating',
      param: 'value',
      Xhr: {
        method: 'put',
        spinner: 'spinner'
      }
    });


## Список опций, :options

Существует следующий простой список опций который вы можете использовать с виджетом рейтинга.
Вы можете использовать их любым доступным способом. Через конструктор, JSON опции в атрибуте
`data-rater-options` или глобально в переменной `Rater.Options`

Имя           | Умолчание | Описание
--------------|-----------|---------------------------------------------------------------
size          | 5         | количество позиций (звездочек) в линии
value         | null      | начальное значение
update        | null      | ссылка на назначаемый элемент
disabled      | false     | флаг, если рейтинг должен быть заблокирован по умолчанию
disableOnVote | false     | флаг, если рейтинг должен быть заблокирован сразу после выбора
url           | null      | url-адрес куда слать результаты выбора
param         | 'rate'    | имя параметра для результата выбора
Xhr           | null      | дополнительные опции для {Xhr} запросов


## Список событий, :events

Виджет рейтинга работает со следующим списком событий.

Имя    | Описание
-------|------------------------------------------------------------
hover  | когда пользователь наводит курсор на какую било звездочку
change | когда пользователь выбирает какое-либо значение
send   | когда {Xhr} запрос с рейтингом был отправлен

Все слушатели получат два аргумента, выбранное значение и ссылку на объект виджета


## API документация, :api

Класс `Rater` имеет следующий простой интерфейс

Имя               | Описание
------------------|--------------------------------------------------
setValue(value)   | устанавливает текущее значение
getValue()        | возвращает текущее значение
insertTo(element, position) | вставляет виджет в указанный элемент
assignTo(element) | назначает рейтинг на работу с указанным элементом
send()            | отправляет рейтинг через {Xhr} запрос
disable()         | блокирует виджет
enable()          | разблокирует виджет
disabled()        | проверяет если виджет заблокирован


## Настройки стилей, :styles

Виджет имеет следующую простую структуру

    <div class="right-rater">
      <div class="right-rater-glow">★</div>
      <div class="right-rater-glow">★</div>
      <div>★</div>
      <div>★</div>
      <div>★</div>
    </div>

Заблокированный виджет так же получит класс `right-rater-disabled`

Далее, для того чтобы не иметь никаких зависимостей от картинок, мы используем utf-8
символы звездочек. Если вы захотите перекрасить их и использовать свои иконки, вот
вам простой пример как это можно сделать.

    div.right-rater div {
      width: 10px;
      height: 10px;
      text-indent: -99em;
      background-image: url('/images/star-off.png');
      background-repeat: no-repeat;
      background-position: center center;
    }
    div.right-rater div.right-rater-glow {
      background-image: url('/images/star-on.png');
    }

