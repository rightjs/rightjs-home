<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <title>RightJS: Documentation: Xhr</title>
    <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
    <link href="../blog.rss" rel="alternate" title="RightJS News" type="application/rss+xml" />
    <script src="../hotlink/right.js@1333128729" type="text/javascript"></script>
<script src="../javascripts/application.js@1295184937" type="text/javascript"></script>
    <script src="../builds/ui/right-autocompleter.js@1333128730" type="text/javascript"></script>
    <link href="../stylesheets/application.css@1297515667.css" media="screen" rel="stylesheet" type="text/css" />
    
    
    
  </head>
  <body>
    <div id="body">
      <div id="head">
        <a href="../index.html" id="logo">RightJS</a>
        <div id="slogan">JavaScript Framework That Feels Right</div>

        <div id="main-menu">
  <ul>
    <li><a href="../index.html">Home</a></li>
    <li><a href="../download.html">Download</a></li>
    <li><a href="../plugins.html">Plugins</a></li>
    <li><a href="../ui.html">UI</a></li>
    <li><a href="../demos.html">Demos</a></li>
    <li class="current"><a href="../docs.html">Docs</a></li>
    <li><a href="../blog.html">Blog</a></li>
  </ul>
  <div id="zing"><!-- the moving thing --></div>
</div>
        <div id="lang-switch">
    <select onchange="document.location.href=this.value;">
      <option selected="true" value="http://rightjs.org/docs/xhr">English</option>
      <option value="http://ru.rightjs.org/docs/xhr">Русский</option>
    </select>
</div>
      </div>
      <div id="main">
        <div id="sidebar">

  <div id="api-search" class="box">
  <input type="text" value="Search API" id="api-search-field" />
  <script type="text/javascript">
  // <![CDATA[
    new Autocompleter($('api-search-field').on({
      focus: function() { this._v = this.value(); this.value(''); },
      blur:  function() { this.value(this._v); }
    }), {
      url: '/docs/search/%{search}.js',
      onDone: function() {
        var current = this.first('.current');
        if (current) {
          document.location.href = current.get('title');
        }
        this.input.setValue(this.input._v);
      }
    });
  // ]]>
  </script>
</div>

  <div class="box" id="api-lists">
    <label>Core</label><ul><li><a href="browser.html">Browser</a></li><li><a href="class.html">Class</a></li><li><a href="util.html">Util</a></li></ul>
<label>Dom</label><ul><li><a href="document.html">Document</a></li><li><a href="element.html">Element</a></li><li><a href="event.html">Event</a></li><li><a href="form.html">Form</a></li><li><a href="input.html">Input</a></li><li><a href="window.html">Window</a></li></ul>
<label>Fx</label><ul><li><a href="fx.html">Fx</a></li><li><a href="fx/attr.html">Fx.Attr</a></li><li><a href="fx/element.html">Fx.Element</a></li><li><a href="fx/fade.html">Fx.Fade</a></li><li><a href="fx/highlight.html">Fx.Highlight</a></li><li><a href="fx/morph.html">Fx.Morph</a></li><li><a href="fx/scroll.html">Fx.Scroll</a></li><li><a href="fx/slide.html">Fx.Slide</a></li></ul>
<label>Lang</label><ul><li><a href="array.html">Array</a></li><li><a href="function.html">Function</a></li><li><a href="json.html">Json</a></li><li><a href="math.html">Math</a></li><li><a href="number.html">Number</a></li><li><a href="object.html">Object</a></li><li><a href="regexp.html">Regexp</a></li><li><a href="string.html">String</a></li></ul>
<label>Util</label><ul><li><a href="cookie.html">Cookie</a></li><li><a href="observer.html">Observer</a></li><li><a href="options.html">Options</a></li><li><a href="xhr.html">Xhr</a></li><ul><li><a href="xhr.html#Options">Options</a></li><li><a href="xhr.html#load">load</a></li><li><a href="xhr.html#initialize">initialize</a></li><li><a href="xhr.html#cancel">cancel</a></li><li><a href="xhr.html#getHeader">getHeader</a></li><li><a href="xhr.html#send">send</a></li><li><a href="xhr.html#setHeader">setHeader</a></li><li><a href="xhr.html#successful">successful</a></li><li><a href="xhr.html#update">update</a></li></ul></ul>
  </div>

  <div class="box">
    <a href='http://www.pledgie.com/campaigns/14259'><img alt='Donate!' src='http://www.pledgie.com/campaigns/14259.png?skin_name=chrome' border='0' /></a>
  </div>

  <div class="box">
    <ul id="social">
      <li><a href="../blog.rss" id="rss-link">RSS</a></li>
      <li><a href="http://twitter.com/rightjs" id="twitter-link">Twitter</a></li>
      <li><a href="http://github.com/rightjs" id="github-link">GitHub</a></li>
    </ul>
  </div>
</div>

        <div id="info">
          
<h1>Xhr</h1>

<p>Xhr is the standard XmlHTTPRequest handler for RightJS.</p>

<h2>Options</h2>

<p>Xhr objects support the following options:</p>
<table><thead><tr><th>Name</th><th>Default</th><th>Description</th></tr></thead><tbody><tr><td>method</td><td>&#8216;post&#8217;</td><td>request method (get/post/put/delete)</td>
</tr><tr><td>encoding</td><td>&#8216;utf-8&#8217;</td><td>encoding</td>
</tr><tr><td>async</td><td>true</td><td>asynchronous request</td>
</tr><tr><td>evalScripts</td><td>false</td><td>extract/eval JavaScripts from the response</td>
</tr><tr><td>evalResponse</td><td>false</td><td>eval response as JavaScript code</td>
</tr><tr><td>evalJSON</td><td>true</td><td>eval JSON responses automatically</td>
</tr><tr><td>secureJSON</td><td>true</td><td>should JSON responses be validated?</td>
</tr><tr><td>urlEncoded</td><td>true</td><td>urlencode the parameters</td>
</tr><tr><td>spinner</td><td>null</td><td>common spinner element</td>
</tr><tr><td>spinnerFx</td><td>&#8216;fade&#8217;</td><td>fx name to show/hide the spinner</td>
</tr><tr><td>params</td><td>null</td><td>default parameters</td>
</tr></tbody></table>
<p>Any of the options can be set globally by altering the <a href='xhr.html#Options' class='api-ref'>Options</a> object or be passed along with any Xhr functionality interface.</p>

<h2>Spinners</h2>

<p>The <a href='xhr.html' class='api-ref'>Xhr</a> class in RightJS handles the spinners automatically. You can specify them as an element object instance or as an element-id.</p>

<code><b class="unit">Xhr</b>.<b class="unit">Options</b>.<u>spinner</u> = $(<s>'spinner'</s>);<br/><br/><i>// now the spinner element will appear before the request</i><br/><i>// and automatically get hidden on complete or cancel</i><br/><b class="var">new</b> <b class="unit">Xhr</b>(<s>'/foo/bar'</s>).<u class="method">send</u>();<br/><br/><i>// in this case Xhr will process both the global and custom spinners</i><br/><b class="var">new</b> <b class="unit">Xhr</b>(<s>'/foo/bar'</s>, {<br/>  <s class="key">spinner</s>: <s>'custom-spinner'</s><br/>}).<u class="method">send</u>();</code>

<h2>Parameters</h2>

<p>You can send custom parameters with XHR requests. Specify them either as a url-encoded string or as an object.</p>

<p>There are three different levels.</p>

<p>You can specify global params, which will be sent with all subsequent XHR requests:</p>

<code><b class="unit">Xhr</b>.<b class="unit">Options</b>.<u>params</u> = <s>'myapp=true'</s>;<br/><br/><i>// will send 'myapp=true' params with any following requests.</i><br/><b class="unit">Xhr</b>.<u class="method">load</u>(<s>'/foo/bar'</s>);<br/><br/><b class="var">new</b> <b class="unit">Xhr</b>(<s>'/foo/bar'</s>).<u class="method">send</u>();</code>

<p>You can specify per-request parameters by sending them as constructor options:</p>

<code><b class="var">var</b> xhr = <b class="var">new</b> <b class="unit">Xhr</b>(<s>'/foo/bar'</s>, {<br/>  <s class="key">params</s>: {<s class="key">myapp</s>: <b class="rest">true</b>}<br/>});<br/><br/>xhr.<u class="method">send</u>(); <i>// the server will see the 'myapp=true' params</i></code>

<p>And you can specify the per-send params using of the <a href='xhr.html#send' class='api-ref'>send</a> method:</p>

<code><b class="var">var</b> xhr = <b class="var">new</b> <b class="unit">Xhr</b>(<s>'/foo/bar'</s>).<u class="method">send</u>(<s>'myapp=true'</s>);</code>

<p><strong>NOTE:</strong> If you specify params on several levels, they will be merged into a single hash once a request is being made.</p>

<h2>Events</h2>

<p>The RightJS <tt>Xhr</tt> class is inherited from the standard <a href='observer.html' class='api-ref'>Observer</a> class, which means that <tt>Xhr</tt> instances follow all the standard observer rules. You can add, list and remove event handlers the usual way.</p>

<p>The <tt>Xhr</tt> class supports the following events:</p>
<table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td>create</td><td>after the XmlHTTPRequest object has been instanciated</td>
</tr><tr><td>request</td><td>after the request has been sent</td>
</tr><tr><td>complete</td><td>after the request has completed (either successfully or not)</td>
</tr><tr><td>success</td><td>after the request bas completed <em>successfully</em></td>
</tr><tr><td>failure</td><td>after the request has <em>failed</em></td>
</tr><tr><td>cancel</td><td>after the request has been canceled <em>manually</em></td>
</tr></tbody></table>
<p><strong>NOTE:</strong> Every callback will receive two arguments. The first one is the request instance and the second one is the actual original request instance.</p>

<p>You can attach listeners to these events globally as well as using the <tt>Xhr</tt> class level observers:</p>

<code><b class="unit">Xhr</b>.<u class="method">onCreate</u>(<b>function</b>() {...});<br/><b class="unit">Xhr</b>.<u class="method">onFailure</u>(<b>function</b>() {...});</code>

<p>In this case <tt>Xhr</tt> will call your listeners on <em>every</em> XHR request.</p>

<h2>JSON handling</h2>

<p>If the option <tt>evalJSON</tt> is true, Xhr will try to evaluate responses that come with a JSON content-type and assign the result to the <tt>responseJSON</tt> property.</p>

<code><b class="unit">Xhr</b>.<u class="method">load</u>(<s>'/some.json'</s>, {<br/>  <s class="key">onSuccess</s>: <b>function</b>(request) {<br/>    <b class="var">var</b> json = request.<u>responseJSON</u>;<br/><br/>    <i>// ....</i><br/>  }<br/>});</code>

<h2>Short Response Names</h2>

<p>To access the server responses use either the standard names <tt>responseText</tt>, <tt>responseXML</tt>, <tt>responseJSON</tt> or any of the shortified names:</p>

<ul>
<li>this.text -&gt; this.responseText</li>

<li>this.xml -&gt; this.responseXML</li>

<li>this.json -&gt; this.responseJSON</li>
</ul>

<h1>Methods</h1>
<p>
  <a href="xhr.html#Options">Options</a>, <a href="xhr.html#load">load</a>, <a href="xhr.html#initialize">initialize</a>, <a href="xhr.html#cancel">cancel</a>, <a href="xhr.html#getHeader">getHeader</a>, <a href="xhr.html#send">send</a>, <a href="xhr.html#setHeader">setHeader</a>, <a href="xhr.html#successful">successful</a>, <a href="xhr.html#update">update</a>
</p>

<div class="method">
  <a name="Options"></a>
  <h2><a class="top-anchor" href="xhr.html#">top &uarr;</a><a href="xhr.html#Options">Options</a></h2>

  <p class="semantic">
    <code><b class="unit">Xhr</b>.<b class="unit">Options</b> -&gt; <b class="unit">Object</b></code>
  </p>


  <h4>Description</h4>
  <p>Default Xhr options, see the options chapter above for more details.</p>



  <h4>Example</h4>
  <p>
    <code><b class="unit">Xhr</b>.<u class="method">load</u>(<s>'/some/url'</s>); <i>// -&gt; 'post' request</i><br/><br/><b class="unit">Xhr</b>.<b class="unit">Options</b>.<u>method</u> = <s>'get'</s>;<br/><br/><b class="unit">Xhr</b>.<u class="method">load</u>(<s>'/some/url'</s>); <i>// -&gt; 'get' request</i></code>
  </p>

</div><div class="method">
  <a name="load"></a>
  <h2><a class="top-anchor" href="xhr.html#">top &uarr;</a><a href="xhr.html#load">load</a></h2>

  <p class="semantic">
    <code><b class="unit">Xhr</b>.<u class="method">load</u>(<b class="unit">String</b> url[, <b class="unit">Object</b> options]) -&gt; <b class="unit">Xhr</b> <b class="var">new</b></code>
  </p>


  <h4>Description</h4>
  <p>Shortcut for <tt>new Xhr(url, options).send();</tt> which creates a new XHR request instance and sends it.</p>

<p><strong>NOTE:</strong> Will perform a <tt>GET</tt> request by default.</p>



  <h4>Example</h4>
  <p>
    <code><b class="unit">Xhr</b>.<u class="method">load</u>(<s>'/some/url'</s>, {<br/>  <s class="key">onSuccess</s>: <b>function</b>(request) {<br/>    <i>// do something about it</i><br/>  }<br/>});</code>
  </p>

</div><div class="method">
  <a name="initialize"></a>
  <h2><a class="top-anchor" href="xhr.html#">top &uarr;</a><a href="xhr.html#initialize">initialize</a></h2>

  <p class="semantic">
    <code>initialize(<b class="unit">String</b> url[, <b class="unit">Object</b> options]) -&gt; <b class="unit">Xhr</b> <b class="var">new</b></code>
  </p>


  <h4>Description</h4>
  <p>Standard constructor. The second argument is an options hash with any of the standard keys.</p>



  <h4>Example</h4>
  <p>
    <code><b class="var">var</b> xhr = <b class="var">new</b> <b class="unit">Xhr</b>(<s>'/some/url'</s>);<br/><b class="var">var</b> xhr = <b class="var">new</b> <b class="unit">Xhr</b>(<s>'/some/url'</s>, {<br/>  <s class="key">method</s>: <s>'get'</s>,<br/>  <s class="key">onSuccess</s>: some_success_handler<br/>});</code>
  </p>

</div><div class="method">
  <a name="cancel"></a>
  <h2><a class="top-anchor" href="xhr.html#">top &uarr;</a><a href="xhr.html#cancel">cancel</a></h2>

  <p class="semantic">
    <code>cancel() -&gt; <b class="unit">Xhr</b> <b class="var">self</b></code>
  </p>


  <h4>Description</h4>
  <p>Cancels an active request.</p>



  <h4>Example</h4>
  <p>
    <code><b class="var">var</b> xhr = <b class="var">new</b> <b class="unit">Xhr</b>(<s>'/foo/bar'</s>);<br/>xhr.<u class="method">send</u>();<br/><br/>xhr.<u class="method">cancel</u>();</code>
  </p>

</div><div class="method">
  <a name="getHeader"></a>
  <h2><a class="top-anchor" href="xhr.html#">top &uarr;</a><a href="xhr.html#getHeader">getHeader</a></h2>

  <p class="semantic">
    <code>getHeader(<b class="unit">String</b> name) -&gt; <b class="unit">String</b> value</code>
  </p>


  <h4>Description</h4>
  <p>Reads the response headers.</p>



  <h4>Example</h4>
  <p>
    <code><b class="var">var</b> xhr = <b class="var">new</b> <b class="unit">Xhr</b>(<s>'/foo/bar'</s>);<br/>xhr.<u class="method">send</u>();<br/><i>// ...</i><br/>xhr.<u class="method">getHeader</u>(<s>'Content-type'</s>);</code>
  </p>

</div><div class="method">
  <a name="send"></a>
  <h2><a class="top-anchor" href="xhr.html#">top &uarr;</a><a href="xhr.html#send">send</a></h2>

  <p class="semantic">
    <code>send([<b class="unit">String</b> params])  -&gt; <b class="unit">Xhr</b> <b class="var">self</b><br/>send([<b class="unit">Object</b> params])  -&gt; <b class="unit">Xhr</b> <b class="var">self</b><br/>send([<b class="unit">Form</b>   element]) -&gt; <b class="unit">Xhr</b> <b class="var">self</b></code>
  </p>


  <h4>Description</h4>
  <p>Sends the request to the server.</p>



  <h4>Example</h4>
  <p>
    <code><b class="var">var</b> xhr = <b class="var">new</b> <b class="unit">Xhr</b>(<s>'/foo/bar'</s>);<br/>xhr.<u class="method">send</u>();<br/><br/><i>// or</i><br/><br/>xhr.<u class="method">send</u>(<s>'foo=bar&amp;moo=boo'</s>);<br/><br/><i>// or</i><br/><br/>xhr.<u class="method">send</u>({<s class="key">foo</s>: <s>'bar'</s>});</code>
  </p>

</div><div class="method">
  <a name="setHeader"></a>
  <h2><a class="top-anchor" href="xhr.html#">top &uarr;</a><a href="xhr.html#setHeader">setHeader</a></h2>

  <p class="semantic">
    <code>setHeader(<b class="unit">String</b> name, <b class="unit">String</b> value) -&gt; <b class="unit">Xhr</b> <b class="var">self</b></code>
  </p>


  <h4>Description</h4>
  <p>Setter for additional headers which should be sent along with the request.</p>



  <h4>Example</h4>
  <p>
    <code><b class="var">var</b> xhr = <b class="var">new</b> <b class="unit">Xhr</b>(<s>'/some/url'</s>);<br/>xhr.<u class="method">setHeader</u>(<s>'Content-type'</s>, <s>'application/x-www-form-urlencoded'</s>);</code>
  </p>

</div><div class="method">
  <a name="successful"></a>
  <h2><a class="top-anchor" href="xhr.html#">top &uarr;</a><a href="xhr.html#successful">successful</a></h2>

  <p class="semantic">
    <code>successful() -&gt; boolean</code>
  </p>


  <h4>Description</h4>
  <p>Checks if the request has completed with a successful status.</p>



  <h4>Example</h4>
  <p>
    <code><b class="var">var</b> xhr = <b class="var">new</b> <b class="unit">Xhr</b>(<s>'/foo/bar'</s>, {<br/>  <s class="key">onComplete</s>: <b>function</b>(request) {<br/>    <b>if</b> (request.<u class="method">successful</u>()) {<br/>      <i>// do something</i><br/>    }<br/>  }<br/>}).<u class="method">send</u>();</code>
  </p>

</div><div class="method">
  <a name="update"></a>
  <h2><a class="top-anchor" href="xhr.html#">top &uarr;</a><a href="xhr.html#update">update</a></h2>

  <p class="semantic">
    <code>update(<b class="unit">Element</b> element[, mixed params])   -&gt; <b class="unit">Xhr</b> <b class="var">self</b><br/>update(<b class="unit">String</b> element_id[, mixed params]) -&gt; <b class="unit">Xhr</b> <b class="var">self</b></code>
  </p>


  <h4>Description</h4>
  <p>Sends the request and then updates the given element with the result of the request.</p>



  <h4>Example</h4>
  <p>
    <code><b class="var">var</b> xhr = <b class="var">new</b> <b class="unit">Xhr</b>(<s>'/foo/bar'</s>);<br/><br/>xhr.<u class="method">update</u>(element);<br/>xhr.<u class="method">update</u>(<s>'element-id'</s>);<br/>xhr.<u class="method">udpate</u>(element, <s>'foo=bar'</s>);<br/>xhr.<u class="method">udpate</u>(element, {<s class="key">foo</s>: <s>'bar'</s>});</code>
  </p>

</div>

        </div>
        <div style="clear:both"></div>
      </div>
      <div id="foot">
        <div id="contacts">
  <h2>Questions?</h2>
  <a href="&#x6D;&#x61;i&#x6C;&#x74;&#x6F;:&#105;&#110;&#102;&#111;&#064;&#114;&#105;&#103;&#104;&#116;&#106;&#115;&#046;&#111;&#114;&#103;">&#105;&#110;&#102;&#111;&#064;&#114;&#105;&#103;&#104;&#116;&#106;&#115;&#046;&#111;&#114;&#103;</a>
</div>
<div id="bottom-menu">
  <h2>About the Framework</h2>
  <a href="../philosophy.html">Philosophy</a> |
  <a href="../benchmarks.html">Benchmarks</a> |
  <a href="../browsers.html">Browsers</a> |
  <a href="../contacts.html">Contacts</a>
</div>
        <div id="design">Design by <a href="http://activestylus.com">Steven Garcia</a></div>
        <div id="copyright">Copyright &copy; 2008-2011 Nikolay Nemshilov</div>
      </div>
    </div>

    <script src="http://www.google-analytics.com/ga.js" type="text/javascript"></script>
    <script type="text/javascript">
    // <![CDATA[
      try { _gat._getTracker("UA-10292980-1")._trackPageview(); } catch(err) {}
    // ]]>
    </script>
  </body>
</html>